<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · Setfield.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Setfield.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Introduction</a><ul class="internal"><li><a class="toctext" href="#Usage-1">Usage</a></li><li><a class="toctext" href="#Under-the-hood-1">Under the hood</a></li></ul></li><li><a class="toctext" href="../">Docstrings</a></li><li><a class="toctext" href="../examples/custom_macros/">Custom Macros</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Introduction</a></li></ul><a class="edit-page" href="https://github.com/jw3126/Setfield.jl/blob/master/docs/src/intro.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Introduction</span><a class="fa fa-bars" href="#"></a></div></header><h2><a class="nav-anchor" id="Usage-1" href="#Usage-1">Usage</a></h2><p>Say we have a deeply nested struct:</p><pre><code class="language-julia-repl">julia&gt; using StaticArrays;

julia&gt; struct Person
           name::Symbol
           age::Int
       end;

julia&gt; struct SpaceShip
           captain::Person
           velocity::SVector{3, Float64}
           position::SVector{3, Float64}
       end;

julia&gt; s = SpaceShip(Person(:julia, 2009), [0.0, 0.0, 0.0], [0.0, 0.0, 0.0])
SpaceShip(Person(:julia, 2009), [0.0, 0.0, 0.0], [0.0, 0.0, 0.0])</code></pre><p>Lets update the captains name:</p><pre><code class="language-julia-repl">julia&gt; s.captain.name = :JULIA
ERROR: type Person is immutable</code></pre><p>It&#39;s a bit cryptic but what it means that Julia tried very hard to set the field but gave it up since the struct is immutable.  So we have to do:</p><pre><code class="language-julia-repl">julia&gt; SpaceShip(Person(:JULIA, s.captain.age), s.velocity, s.position)
SpaceShip(Person(:JULIA, 2009), [0.0, 0.0, 0.0], [0.0, 0.0, 0.0])</code></pre><p>This is messy and things get worse, if the structs are bigger. <code>Setfields</code> to the rescue!</p><pre><code class="language-julia-repl">julia&gt; using Setfield

julia&gt; s = @set s.captain.name = :JULIA
SpaceShip(Person(:JULIA, 2009), [0.0, 0.0, 0.0], [0.0, 0.0, 0.0])

julia&gt; s = @set s.velocity[1] += 999999
SpaceShip(Person(:JULIA, 2009), [999999.0, 0.0, 0.0], [0.0, 0.0, 0.0])

julia&gt; s = @set s.velocity[1] += 1000001
SpaceShip(Person(:JULIA, 2009), [2.0e6, 0.0, 0.0], [0.0, 0.0, 0.0])

julia&gt; @set s.position[2] = 20
SpaceShip(Person(:JULIA, 2009), [2.0e6, 0.0, 0.0], [0.0, 20.0, 0.0])</code></pre><h2><a class="nav-anchor" id="Under-the-hood-1" href="#Under-the-hood-1">Under the hood</a></h2><p>Under the hood this package implements a simple <a href="https://hackage.haskell.org/package/lens">lens</a> api. This api may be useful in its own rite and works as follows:</p><pre><code class="language-julia-repl">julia&gt; using Setfield

julia&gt; l = @lens _.a.b
(@lens _.a.b)

julia&gt; struct AB;a;b;end

julia&gt; obj = AB(AB(1,2),3)
AB(AB(1, 2), 3)

julia&gt; set(obj, l, 42)
AB(AB(1, 42), 3)

julia&gt; obj
AB(AB(1, 2), 3)

julia&gt; get(obj, l)
2

julia&gt; modify(x-&gt;10x, obj, l)
AB(AB(1, 20), 3)</code></pre><p>Now the <code>@set</code> macro simply provides sugar for creating a <code>lens</code> and applying it. For instance</p><pre><code class="language-julia">@set obj.a.b = 42</code></pre><p>expands roughly to</p><pre><code class="language-julia">l = @lens _.a.b
set(obj, l, 42)</code></pre><footer><hr/><a class="next" href="../"><span class="direction">Next</span><span class="title">Docstrings</span></a></footer></article></body></html>
